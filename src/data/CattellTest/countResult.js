// countResult.js

// Ключ для подсчета баллов по факторам
export const scoringKey = {
	MD: {
		1: { b: 1, a: 2 },
		18: { b: 1, c: 2 },
		35: { b: 1, c: 2 },
		52: { b: 1, a: 2 },
		69: { b: 1, c: 2 },
		86: { b: 1, c: 2 },
		103: { b: 1, c: 2 },
	},
	A: {
		2: { b: 1, c: 2 },
		19: { b: 1, a: 2 },
		36: { b: 1, c: 2 },
		53: { b: 1, a: 2 },
		70: { b: 1, a: 2 },
		87: { b: 1, c: 2 },
		104: { a: 1 },
	},
	B: {
		3: { b: 1 },
		20: { c: 1 },
		37: { b: 1 },
		54: { c: 1 },
		71: { a: 1 },
		88: { c: 1 },
		105: { b: 1 },
	},
	C: { 4: { a: 2 }, 21: { a: 2 }, 38: { c: 2 }, 55: { a: 2 }, 72: { c: 2 }, 89: { c: 2 } },
	E: { 5: { c: 2 }, 22: { c: 2 }, 39: { c: 2 }, 56: { a: 2 }, 73: { c: 2 }, 90: { a: 2 } },
	F: { 6: { c: 2 }, 23: { a: 2 }, 40: { c: 2 }, 57: { a: 2 }, 74: { a: 2 }, 91: { c: 2 } },
	G: { 7: { a: 2 }, 24: { c: 2 }, 41: { a: 2 }, 58: { c: 2 }, 75: { a: 2 }, 92: { c: 2 } },
	H: { 8: { a: 2 }, 25: { c: 2 }, 42: { c: 2 }, 59: { a: 2 }, 76: { a: 2 }, 93: { c: 2 } },
	I: { 9: { a: 2 }, 26: { a: 2 }, 43: { c: 2 }, 60: { a: 2 }, 77: { c: 2 }, 94: { c: 2 } },
	L: { 10: { a: 2 }, 27: { c: 2 }, 44: { c: 2 }, 61: { c: 2 }, 78: { a: 2 }, 95: { a: 2 } },
	M: { 11: { c: 2 }, 28: { c: 2 }, 45: { a: 2 }, 62: { a: 2 }, 79: { a: 2 }, 96: { c: 2 } },
	N: { 12: { c: 2 }, 29: { b: 1, c: 2 }, 46: { a: 2 }, 63: { a: 2 }, 80: { c: 2 }, 97: { c: 2 } },
	O: { 13: { c: 2 }, 30: { a: 2 }, 47: { c: 2 }, 64: { a: 2 }, 81: { c: 2 }, 98: { a: 2 } },
	Q1: { 14: { a: 2 }, 31: { a: 2 }, 48: { c: 2 }, 65: { c: 2 }, 82: { c: 2 }, 99: { a: 2 } },
	Q2: { 15: { a: 2 }, 32: { c: 2 }, 49: { a: 2 }, 66: { a: 2 }, 83: { c: 2 }, 100: { c: 2 } },
	Q3: { 16: { a: 2 }, 33: { a: 2 }, 50: { a: 2 }, 67: { a: 2 }, 84: { c: 2 }, 101: { c: 2 } },
	Q4: { 17: { a: 2 }, 34: { c: 2 }, 51: { c: 2 }, 68: { a: 2 }, 85: { c: 2 }, 102: { a: 2 } },
};

// Таблица перевода "сырых" оценок в стены
export const rawToSten = {
	MD: { 0: 3, 1: 4, 2: 5, 3: 6, 4: 7, 5: 8, 6: 9, 7: 10, 8: 11, 9: 12 },
	A: { 0: 5, 1: 5, 2: 6, 3: 7, 4: 8, 5: 9, 6: 10, 7: 11, 8: 12 },
	B: { 0: 4, 1: 4, 2: 5, 3: 6, 4: 7, 5: 8, 6: 9, 7: 10, 8: 11 },
	C: { 0: 4, 1: 5, 2: 6, 3: 7, 4: 8, 5: 9, 6: 10, 7: 11, 8: 12 },
	E: { 0: 4, 1: 5, 2: 6, 3: 7, 4: 8, 5: 9, 6: 10, 7: 11, 8: 12 },
	F: { 0: 4, 1: 5, 2: 6, 3: 7, 4: 8, 5: 9, 6: 10, 7: 11, 8: 12 },
	G: { 0: 4, 1: 5, 2: 6, 3: 7, 4: 8, 5: 9, 6: 10, 7: 11, 8: 12 },
	H: { 0: 4, 1: 5, 2: 6, 3: 7, 4: 8, 5: 9, 6: 10, 7: 11, 8: 12 },
	I: { 0: 4, 1: 5, 2: 6, 3: 7, 4: 8, 5: 9, 6: 10, 7: 11, 8: 12 },
	L: { 0: 4, 1: 5, 2: 6, 3: 7, 4: 8, 5: 9, 6: 10, 7: 11, 8: 12 },
	M: { 0: 4, 1: 5, 2: 6, 3: 7, 4: 8, 5: 9, 6: 10, 7: 11, 8: 12 },
	N: { 0: 4, 1: 5, 2: 6, 3: 7, 4: 8, 5: 9, 6: 10, 7: 11, 8: 12 },
	O: { 0: 4, 1: 5, 2: 6, 3: 7, 4: 8, 5: 9, 6: 10, 7: 11, 8: 12 },
	Q1: { 0: 4, 1: 5, 2: 6, 3: 7, 4: 8, 5: 9, 6: 10, 7: 11, 8: 12 },
	Q2: { 0: 4, 1: 5, 2: 6, 3: 7, 4: 8, 5: 9, 6: 10, 7: 11, 8: 12 },
	Q3: { 0: 4, 1: 5, 2: 6, 3: 7, 4: 8, 5: 9, 6: 10, 7: 11, 8: 12 },
	Q4: { 0: 4, 1: 5, 2: 6, 3: 7, 4: 8, 5: 9, 6: 10, 7: 11, 8: 12 },
};

// Функция для подсчета баллов по факторам
export function countScores(answers, scoringKey) {
	const scores = {};

	for (const [factor, questions] of Object.entries(scoringKey)) {
		scores[factor] = 0;
		for (const [question, points] of Object.entries(questions)) {
			const answer = answers[question];
			if (answer && points[answer] !== undefined) {
				scores[factor] += points[answer];
			}
		}
	}

	return scores;
}

// Функция для перевода "сырых" оценок в стены
export function convertToSten(rawScores, rawToSten) {
	const stenScores = {};

	for (const [factor, rawScore] of Object.entries(rawScores)) {
		stenScores[factor] = rawToSten[factor][rawScore];
	}

	return stenScores;
}

export function interpretResults(stenScores) {
	const interpretation = {};
	const descriptions = {
		MD: {
			low: 'Низкая мотивация к выполнению теста',
			medium: 'Средняя мотивация к выполнению теста',
			high: 'Высокая мотивация к выполнению теста',
		},
		A: {
			low: 'Замкнутость, сдержанность',
			medium: 'Умеренная общительность',
			high: 'Общительность, открытость',
		},
		B: {
			low: 'Низкий уровень абстрактного мышления',
			medium: 'Средний уровень абстрактного мышления',
			high: 'Высокий уровень абстрактного мышления',
		},
		C: {
			low: 'Эмоциональная неустойчивость',
			medium: 'Умеренная эмоциональная устойчивость',
			high: 'Эмоциональная устойчивость',
		},
		E: {
			low: 'Покорность, уступчивость',
			medium: 'Умеренная напористость',
			high: 'Доминантность, напористость',
		},
		F: {
			low: 'Серьезность, осторожность',
			medium: 'Умеренная живость',
			high: 'Живость, импульсивность',
		},
		G: {
			low: 'Низкая нормативность поведения',
			medium: 'Умеренная нормативность поведения',
			high: 'Высокая нормативность поведения',
		},
		H: {
			low: 'Робость, застенчивость',
			medium: 'Умеренная смелость',
			high: 'Смелость, авантюризм',
		},
		I: {
			low: 'Жесткость, практичность',
			medium: 'Умеренная чувствительность',
			high: 'Чувствительность, мягкость',
		},
		L: {
			low: 'Доверчивость',
			medium: 'Умеренная подозрительность',
			high: 'Подозрительность, ревнивость',
		},
		M: {
			low: 'Практичность, реалистичность',
			medium: 'Умеренная мечтательность',
			high: 'Мечтательность, творческость',
		},
		N: {
			low: 'Прямота, наивность',
			medium: 'Умеренная дипломатичность',
			high: 'Дипломатичность, проницательность',
		},
		O: {
			low: 'Уверенность в себе',
			medium: 'Умеренная тревожность',
			high: 'Тревожность, беспокойство',
		},
		Q1: {
			low: 'Консерватизм',
			medium: 'Умеренная радикальность',
			high: 'Радикальность, экспериментаторство',
		},
		Q2: {
			low: 'Зависимость от группы',
			medium: 'Умеренная самодостаточность',
			high: 'Самодостаточность, независимость',
		},
		Q3: {
			low: 'Низкий самоконтроль',
			medium: 'Умеренный самоконтроль',
			high: 'Высокий самоконтроль',
		},
		Q4: {
			low: 'Расслабленность',
			medium: 'Умеренная напряженность',
			high: 'Напряженность, фрустрированность',
		},
	};

	for (const [factor, sten] of Object.entries(stenScores)) {
		let level = 'medium';
		if (sten < 4) level = 'low';
		if (sten > 7) level = 'high';

		interpretation[factor] = {
			score: sten,
			description: descriptions[factor]?.[level] || 'Нет данных для интерпретации',
		};
	}

	return interpretation;
}
